# 数据持久化

你或许在之前的小节中已经发现，每当我们启动一个新的容器，我们就会丢失之前的 todo list 。这是因为容器中的数据文件都是临时的，一旦容器被摧毁数据也会消失，在本节中我们将会学习如何持久化我们的数据。

## 容器文件系统

当容器运行时，它将镜像中的各个层用作其文件系统。每个容器也有自己的“暂存空间”来创建/更新/删除文件。在另一个容器中不会看到任何更改，即使它们使用相同的图像。

## 验证练习

下面我们将通过以下几个步骤来进行验证，我们将会启动两个相同的容器并且在每个容器中创建一个文件。你将会发现容器的文件系统是相互独立的。

1. 启动一个 `ubuntu` 容器并创建一个 `/data.txt` 的文件，在文件中写入 1 - 10000 的随机数。  
   `docker run -d ubuntu bash -c "shuf -i 1-10000 -n 1 -o /data.txt && tail -f /dev/null"`  
   这条命令会以后台的方式运行一个 unbuntu 容器，并在启东时通过 bash 执行两条命令(`&&` 就是命令的分隔符)。`shuf -i 1-10000 -n 1 -o /data.txt` 随机生成一个 1 - 10000 以内的随机数并写入 `/data.txt` 文件中，`tail -f /dev/null` 则会保持容器运行。(关于如何保持容器运行我们会在后面详细讲解)
2. 找到我们刚才启动的 ubuntu 容器 ID，通过以下命令进入容器中  
   `docker exec -it <CONTAINER-ID> bash`  
   现在我们已经进入到了刚才启动的 ubuntu 容器中，通过以下命令查看 `/data.txt` 中的随机数字  
   `cat /data.txt`

   > 小技巧: 我们可以通过这条命令直接查看容器的文件内容，而不需要进入到容器中  
   > `docker exec <CONTAINER-ID> cat /data.txt`

   > 另一个小技巧，容器 ID 不用完全复制，只要能让 Docker 分别是哪一个容器即可

3. 现在让我们在另一个容器中验证文件是否存在
   `docker run -it ubuntu ls /`  
   我们会发现目录下没有 `/data.txt` 文件存在，这是因为容器的临时文件系统是相互独立的。

4. 现在让我们通过 `docker rm -f <container-id>` 命令删除掉刚才运行的 ubuntu 容器。
